services:
  x11-forwarding:
    # service name
    # enable X11 forwarding
    environment:
      # environment of the container
      - DISPLAY=${DISPLAY:-:0} # pass the host `$DISPLAY` var, defaults to `:0`
    volumes:
      # volumes mount, syntax is `<path on host>:<path on container>`
      - /tmp/.X11-unix:/tmp/.X11-unix # X11 socket

  router:
    extends:
      service: x11-forwarding
    build:
      # use a custom image
      # by default look for `./Dockerfile`
      target: router # use the `router` stage
    cap_add:
      # by default the root user in containers do not have all capacities
      - NET_ADMIN # Perform various network-related operations.
      - SYS_ADMIN # Perform a range of system administration operations.

  client:
    extends:
      service: x11-forwarding
    build:
      target: client
    cap_add:
    - NET_ADMIN
